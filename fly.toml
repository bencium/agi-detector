# fly.toml - Fly.io deployment configuration for AGI Detector
# Deploy with: fly deploy --no-cache

app = "agi-detector"
primary_region = "lhr"  # London - change to your preferred region

[build]
  dockerfile = "Dockerfile"

[env]
  NODE_ENV = "production"
  # Playwright runs in container
  PLAYWRIGHT_BROWSERS_PATH = "/ms-playwright"

[http_service]
  internal_port = 3000
  force_https = true
  auto_stop_machines = true
  auto_start_machines = true
  min_machines_running = 0
  processes = ["app"]

[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory_mb = 1024  # Increased for Playwright

# PostgreSQL database (Neon recommended, or fly postgres)
# fly postgres create --name agi-detector-db
# fly postgres attach agi-detector-db

# Secrets to set:
# fly secrets set DATABASE_URL=<connection_string>
# fly secrets set OPENAI_API_KEY=<openai_api_key>
# fly secrets set KAGGLE_USERNAME=<kaggle_username>
# fly secrets set KAGGLE_KEY=<kaggle_api_key>
# fly secrets set GITHUB_TOKEN=<github_pat>
# fly secrets set BRAVE_API_KEY=<brave_key>  # optional
